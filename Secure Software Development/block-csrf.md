# Write A Web Application That Blocks Cross-Site Request Forgery
A cross-site request forgery (CSRF) vulnerability allows attackers to perform unauthorized actions on behalf of a user by tricking them into clicking a malicious link or visiting a harmful site. CSRF attacks target actions rather than data theft, as attackers cannot view the response. To prevent CSRF, a unique token is generated by the website and included in requests, ensuring they come from a trusted source


## References
- [Cross Site Request Forgery (CSRF)](https://owasp.org/www-community/attacks/csrf) by OWASP


## Tasks
- Create a web application with the following features:
  - A password-update web page that allows authenticated users to change their passwords
  - Generate a unique CSRF token for each user session on the password-update page
  - Include the CSRF token as a hidden field in the password change form
  - Verify the CSRF token on the server-side when processing the password change request
  - Reject the request if the CSRF token is missing or invalid, preventing unauthorized password changes


## Benchmarks
- Write a CSRF exploit for the password-update web page
- Use the exploit to attempt an unauthorized password change
- The CSRF protection mechanism successfully blocks the unauthorized request


## Solutions With Scripts
- [Link to the folder of scripts](https://github.com/aaronamran/MCSI-Remote-Cybersecurity-Internship/tree/main/Secure%20Software%20Development/scripts/block-csrf)

1. Start XAMPP and navigate to the XAMPP folder
2. In the XAMPP htdocs directory, create a folder called 'blockcsrf' and add the following files: `index.php`, `password_update.php`, `process_update.php`, `csrf_token.php` and `csrf_exploit.html`
3. Open a web browser and navigate to localhost. Access the web application at `index.php` and login
4. Navigate to `password_update.php` to see the CSRF token in the form
5. Open the browser developer tools, inspect the form to confirm that the CSRF token is included as a hidden input
6. Use the `csrf_exploit.html` page to simulate a CSRF exploit attempt
7. Confirm that the application blocks the exploit attempt due to the missing/invalid CSRF token
